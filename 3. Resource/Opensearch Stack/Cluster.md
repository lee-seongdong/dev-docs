# Cluster
여러 Node로 구성된 논리적 집합  
데이터를 분산처리하고 확장성 및 고가용성을 제공한다.

## 1. 주요 기능
### 1.1. 확장성 확보 및 데이터 분산 처리
- 여러 노드들이 각 Shard에서 데이터를 분산 처리하여, 고성능의 서비스 가능
- Shard는 물리적인 단위로 데이터가 저장되기 때문에, 단일 노드 환경에서는 분산 처리 불가능.
- Shard가 1개라면 노드를 추가해도 데이터 분산이 이루어지지 않아 확장성 확보 어려움.

### 1.2. 고가용성
- 여러 노드에 Replica를 저장하여, 특정 노드에서 장애가 발생하더라도 지속적인 서비스 가능.
- Replica를 여러 개 설정해야 고가용성 확보 가능.
- Replica가 1개라면 특정 노드 장애 시 고가용성 보장 어려움.


## 2. 클러스터 상태 모니터링
**Opensearch Dashboard**나 API를 통해 클러스터 상태를 실시간으로 모니터링 가능.
- **green**: 모든 샤드가 정상적으로 할당된 상태
- **yellow**: 모든 `Primary 샤드`는 할당되었지만, 일부 `Replica 샤드`가 할당되지 않은 상태. 데이터 손실은 없지만, 고가용성이 보장되지 않는 상태
- **red**: 일부 `Primary 샤드`가 할당되지 않은 상태. 데이터 손실 가능성이 있음
  

## 3. 성능 최적화
### 3.1. 클러스터 용량
`클러스터 전체 필요 용량` = `원본 데이터` * `(1 + 복제본 수)` * `오버헤드(1.1)`

### 3.2. 샤드 크기 조절
샤드 크기를 적절히 설정하여 관리 오버헤드 최소화.
- 샤드의 크기가 너무 작으면 오버헤드가 증가
- 샤드의 크기가 너무 크면 성능이 저하

### 3.3. 레플리카 수 조절
레플리카를 적절히 조정하여 읽기 성능과 고가용성 확보.
- 레플리카가 노드 수보다 많아지면 비활성 Replica가 발생하여 클러스터 상태가 `yellow`로 표시될 수 있음.
- 비활성 Replica는 고가용성을 저해하고, 리소스를 낭비하며, 노드 추가 시 복구 지연 가능성이 있음.
