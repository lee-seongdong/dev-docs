## 이슈
취약한 암호화 모드인 ECB, CBC를 사용중임

## 사전지식
암호화 알고리즘은 크게 3종류로 분류할 수 있다.
- 해시
- 대칭 키 암호화
- 비대칭 키 암호화

### 해시
해시 함수를 통해 데이터를 해시값(다이제스트)으로 변환하여 암호화하는 알고리즘  
해시 함수의 특성상 복호화가 불가능하기 때문에, 데이터 검증에 주로 사용됨

#### 종류
  - MD5
  - SHA128
  - SHA256

#### 취약점
- Rainbow Table Attack : 주로 사용되는 모든 데이터의 해시값을 저장해둔 레인보우 테이블을 사용한 공격. 동일한 데이터는 동일한 해시값을 가진다는 해시함수의 특성을 이용한 공격 기법이다.
- Brute force Attack : 무차별적인 대입으로 실제 해시값이 나올때까지 공격하는 기법

#### 대응
- Key stretching : 해시 함수를 한번이 아니라 여러번 통과시키는 방법
- Salting : 실제 데이터에 임의의값을 이어붙여 해시 함수를 통과시키는 방법


### 대칭 키 암호화
암호화와 복호화에 사용되는 키가 동일한 암호화 알고리즘  
데이터 처리 방식에 따라 **블록 암호화**와 **스트림 암호화**로 나뉜다.

#### 종류
- 블록 암호화 : 데이터를 고정된 크기(블록)로 나누어 처리
  - AES (Advanced Encryption Standard)
  - DES (Data Encryption Standard)
- 스트림 암호화 : 데이터를 연속적인 비트단위로 처리
  - RC4
  - ChaCha20
  - Rabbit
  - Salsa20

#### 블록 암호화의 운영 모드
- ECB : 가장 기본적인 모드로, 키만 사용하여 처리하는 하는 모드. 
  - 구현이 간단하고, 병렬처리 가능
  - 항상 같은 결과가 나오기 때문에 역추적이 가능하고, 데이터 패턴이 노출될 수 있음.  
![ECB 암호화](<../../5. Attached File/ECB_encryption.svg>)
![ECB 복호화](<../../5. Attached File/ECB_decryption.svg>)
- CBC : 이전 암호문 블록과 키를 XOR 연산 후 암호화하는 모드. 첫 암호화는 초기화 벡터(IV)값과 XOR 연산함. 이때 IV의 길이는 16바이트
  - 데이터 패턴이 암호문에 나타나지 않음
  - 같은 평문이여도 다른 암호문으로 변환됨. (항상 같은 결과가 나오던 ECB의 단점을 보완)
  - 병렬처리가 어려움
  - 오라클 패딩 공격에 취약함  
![CBC 암호화](<../../5. Attached File/CBC_encryption.svg>)
![CBC 복호화](<../../5. Attached File/CBC_decryption.svg>)
- CTR : 평문을 암호화 하는것이 아니라, 카운터값(Nonce + counter)을 암호화하여 스트림을 생성하고, 이 스트림을 평문블록과 XOR 연산하여 암호화하는 모드. Nonce의 길이는 12바이트, counter의 길이는 4바이트
  - 암호화와 복호화가 반대의 절차가 아닌 동일한 절차로 이루어진다.  
    구현이 간단하고, 복호화 과정에서 무결성 검증이 가능함. 
  - 이전 암호문과 상관없이 암호화가 가능하므로 병렬처리가 가능  
![CTR 암호화](<../../5. Attached File/CTR_encryption.svg>)
![CTR 복호화](<../../5. Attached File/CTR_decryption.svg>)
- GCM : CTR 모드 암호화에 무결성 검증 단계를 추가한 모드  
![GCM 모드](<../../5. Attached File/GCM.svg>)

### 비대칭 키 암호화
공개키와 개인키 쌍을 사용하여 데이터를 암호화 및 복호화 하는 알고리즘  
전자서명 등에 주로 사용됨

#### 종류
  - RSA
  - DSA
  - ECC


## 해결
비교적 안전한 모드인 GCM 모드로 변경
